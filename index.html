<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta property="og:image" content="img/soong-og.png" />
    <meta name="description" content="「跨出這一步，一起找出路」，一起打拼，台灣新生產生器" />
    <title>一起打拼，台灣新生產生器</title>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-3607701-11', 'auto');
        ga('send', 'pageview');
    </script>
    <script src="https://fb.me/react-0.13.3.min.js"></script>
    <script src="https://fb.me/JSXTransformer-0.13.3.js"></script>
<style>
.content{
    margin: 0;
    margin-right: auto;
    margin-left: auto;
    width: 640px;
}

img.cc{
    width: 150px;
}

.sign{
    width: 100%;
    text-align: right;
}

canvas {
    display: block;
    margin: 0 auto 20px;
}

#download, #text {
    display: block;
    width: 90%;
    margin: 0 auto 20px;
}

#text {
    height: 80px;
    font-size: 30px;
    margin: 0 auto 20px;
    padding: 0;
}

#download {
    height: 40px;
    background-color: #CAEFFF;
    border: 0;
    box-shadow: 0 3px 0px rgba(37, 81, 90, 0.5);
    font-size: 24px;
    font-family: 'Arial';
    color: #5D7D6E;
    margin: 0 auto 10px;
}
</style>
</head>
<body>
    <div class="content">
        <h1>一起打拼，台灣新生產生器</h1>
        <a href="https://github.com/qcl/SoongPosterGenerator"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
        <canvas id="canvas" width="300" height="400"></canvas>
        <h2 style="text-align: center;">想說什麼？</h2>
        <div id='text-container'></div>
        <button id="download">下載圖片</button>
        <div>
    </div>
    <img id="soongPoster" style="display:none" src="img/soong-poster.png" />
<script>

window.onload = function(){
    var downloadBtn = document.getElementById("download");

    downloadBtn.onclick = function(){
        var textContent = document.getElementById("text").value;
        ga("send","event","MasterQuote","Download",textContent);
        var dataURL = canvas.toDataURL();
        window.open(dataURL);
    };
};
</script>

<script type="text/jsx">
    var TextComponent = React.createClass({
        getInitialState: function () {
            var canvas = document.getElementById("canvas");
            this.textArea = [0, 300, 300, 400];
            this.lineHeight = 30;
            this.imgArea = [0, 0, 300, 400];

            return {
                text: '不過你們放心\n   我會特赦你們'
            };
        },

        componentDidMount: function () {
            var canvas = document.getElementById("canvas");
            var context = canvas.getContext("2d");

            this.drawMaster(context);
            this.drawWords(context);
        },

        componentDidUpdate: function () {
            var canvas = document.getElementById("canvas");
            var context = canvas.getContext("2d");

            this.drawMaster(context);
            this.drawWords(context);
        },

        handleChange: function (e) {
            this.setState({ text: e.target.value });
        },

        drawMaster: function(context) {
            context.clearRect.apply(context, this.imgArea);
            var img = document.getElementById("soongPoster");
            context.drawImage.apply(context, [img].concat(this.imgArea));
        },

        drawWords: function (context) {
            var textCenter = (this.textArea[0] + this.textArea[2])/2;
            var textContent = this.state.text;

            if(textContent.length>0){
                var line = textContent.split("\n");
                context.fillStyle = "#fff";
                context.font = "25pt Times New Roman";
                context.textAlign = "center";
                for(var i = 0; i<line.length; i++){
                    context.fillText(line[i], textCenter, this.textArea[1] + this.lineHeight*(i+1));
                }
                ga("send","event","MasterQuote","Preview",textContent);
            }
        },
        render: function() {
            return (
              <textarea id='text' placeholder='一起打拼，台灣新生' rows='5' cols='40' onChange={this.handleChange}>
                {this.state.text}
              </textarea>
            );
        }
    });

    React.render(
        <TextComponent />,
        document.getElementById('text-container')
    );
</script>
<hr />
<p>幕僚透露，當天原本是要拍攝平面照片，宋楚瑜到了攝影棚，才知道有規劃潑泥巴的橋段，一潑就潑了10多分鐘，有2個潑得很賣力。宋楚瑜開玩笑說：「如果是戒嚴時期，我就把你們給斃了，不過你們放心，我會特赦你們。」宋語畢，現場哄堂大笑。</p>
<p class="sign"><a href="http://www.storm.mg/article/60290"><i>（風傳媒）塗泥巴照片引熱議 宋楚瑜幕僚：全是年輕朋友的點子</i></a></p>
<hr />
    <p class="sign">@qcl</p>
</div>
</body>
</html>
